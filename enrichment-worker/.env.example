# Enrichment Worker Environment Variables
# Copy to .env and fill in your values

# === Redis (Upstash) ===
UPSTASH_REDIS_REST_URL=https://your-redis.upstash.io
UPSTASH_REDIS_REST_TOKEN=your_token_here

# Redis Keys
REFLECTIONS_NORMALIZED_KEY=reflections:normalized
REFLECTIONS_ENRICHED_KEY=reflections:enriched
WORKER_STATUS_KEY=worker:status

# === Ollama ===
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=phi3:latest
OLLAMA_TIMEOUT=30

# === OpenVINO Enrichment (NEW) ===
# Implementation: 'legacy' (Ollama) or 'openvino' (Intel GPU/NPU)
ENRICH_IMPL=legacy

# OpenVINO device priority: GPU (Intel Arc) -> NPU -> CPU
OV_DEVICE=GPU

# Path to OpenVINO IR model directory
OV_MODEL_DIR=models/ov/phi3-mini

# Canary rollout: 0-100% of requests to use OpenVINO (0=disabled)
ENRICH_CANARY_PERCENT=0

# Auto-rollback to legacy if OpenVINO fails
AUTO_ROLLBACK=true

# Stage 2 temperature (used by both legacy and OpenVINO)
STAGE2_TEMPERATURE=0.8
STAGE2_TIMEOUT=360

# === Hugging Face (for Hybrid Scorer) ===
HF_TOKEN=hf_your_token_here

# === Hybrid Scorer Fusion Weights ===
# Must sum to 1.0 (default: HF=0.4, Emb=0.3, Ollama=0.3)
HF_WEIGHT=0.4
EMB_WEIGHT=0.3
OLLAMA_WEIGHT=0.3

# === Worker Config ===
WORKER_POLL_MS=500
WORKER_BATCH_SIZE=5
BASELINE_BLEND=0.35
LOG_LEVEL=info

# === Timezone ===
TIMEZONE=Asia/Kolkata

# === Health Check Server ===
HEALTH_PORT=8001
HEALTH_HOST=0.0.0.0

# === Analytics Config ===
# Temporal EMAs
EMA_WINDOWS=1,7,28

# Z-score baseline
ZSCORE_WINDOW_DAYS=90

# Recursion
RECURSION_ENABLED=true
RECURSION_MAX_LINKS=5
RECURSION_SIMILARITY_THRESHOLD=0.7

# Willingness scoring
WILLINGNESS_ENABLED=true

# Weak risk signals
RISK_SIGNALS_ENABLED=true
RISK_ANERGY_THRESHOLD=3
RISK_IRRITATION_THRESHOLD=3
RISK_WINDOW_DAYS=5
