# üö® URGENT: Set Up Local Environment Variables

## The Error You're Seeing
```
Error saving reflection: Error: Failed to save reflection
```

**Root Cause**: The `@vercel/kv` client needs environment variables to connect to Upstash Redis, but they're not configured locally.

## Quick Fix

### Step 1: Get Your Credentials
1. Go to https://vercel.com/dashboard
2. Select your project (Leo)
3. Go to **Settings** ‚Üí **Environment Variables**
4. Copy these two values:
   - `KV_REST_API_URL`
   - `KV_REST_API_TOKEN`

**OR** go directly to Upstash:
1. Go to https://console.upstash.com/
2. Select your Redis database
3. Click **REST API** tab
4. Copy the endpoint URL and token

### Step 2: Create `.env.local` File

Create `apps/web/.env.local` with this content:

```bash
# Vercel KV (Upstash Redis) - REQUIRED for local development
KV_REST_API_URL=https://your-redis-instance.upstash.io
KV_REST_API_TOKEN=your_token_here

# NextAuth Configuration
NEXTAUTH_SECRET=your_nextauth_secret_here
NEXTAUTH_URL=https://localhost:3000

# Google OAuth (optional for local dev, can use guest mode)
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
```

### Step 3: Restart Dev Server

After creating `.env.local`:

```powershell
# Stop the current dev server (Ctrl+C in the terminal)
# Then restart:
npm run dev:https
```

### Step 4: Test Again

Try saving a reflection. You should see in the terminal:
```
‚úÖ Pig info saved: pig_test test pig
‚úÖ Reflection saved to KV: refl_1729307... Owner: guest:sess_...
```

## Why This Happened

- ‚úÖ Vercel automatically injects environment variables in **production**
- ‚ùå Local development needs `.env.local` file
- The KV client silently fails without proper credentials

## Alternative: Use Vercel CLI

If you have Vercel CLI installed, you can pull the env vars:

```powershell
vercel env pull apps/web/.env.local
```

This automatically downloads all production environment variables.

---

**Next Step**: Once you have `.env.local` set up, delete this file and restart the dev server!
